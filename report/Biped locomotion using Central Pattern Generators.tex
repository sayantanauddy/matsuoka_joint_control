\documentclass[12pt,twoside]{article}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Meta informations:
\newcommand{\trauthor}{Sayantan Auddy}
\newcommand{\trtype}{Seminar Paper} %{Seminararbeit} %{Proseminararbeit}
\newcommand{\trcourse}{Independent Study}
\newcommand{\trtitle}{Biped Locomotion using Central Pattern Generators}
\newcommand{\trmatrikelnummer}{6640595}
\newcommand{\tremail}{4auddy@informatik.uni-hamburg.de}
\newcommand{\trarbeitsbereich}{Knowledge Technology, WTM}
\newcommand{\trdate}{03.11.2016}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Languages:

% Falls die Ausarbeitung in Deutsch erfolgt:
% \usepackage[german]{babel}
% \usepackage[T1]{fontenc}
% \usepackage[latin1]{inputenc}
% \usepackage[latin9]{inputenc}	 				
% \selectlanguage{german}

% If the thesis is written in English:
\usepackage[english]{babel} 						
\selectlanguage{english}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Bind packages:
\usepackage{acronym}                    % Acronyms
\usepackage{algorithmic}				% Algorithms and Pseudocode
\usepackage{algorithm}					% Algorithms and Pseudocode
\usepackage{amsfonts}                   % AMS Math Packet (Fonts)
\usepackage{amsmath}                    % AMS Math Packet
\usepackage{amssymb}                    % Additional mathematical symbols
\usepackage{amsthm}
\usepackage{booktabs}                   % Nicer tables
%\usepackage[font=small,labelfont=bf]{caption} % Numbered captions for figures

\usepackage{color}                      % Enables defining of colors via \definecolor
\definecolor{uhhRed}{RGB}{254,0,0}      % Official Uni Hamburg Red
\definecolor{uhhGrey}{RGB}{122,122,120} % Official Uni Hamburg Grey
\usepackage{fancybox}                   % Gleichungen einrahmen
\usepackage{fancyhdr}					% Packet for nicer headers
%\usepackage{fancyheadings}             % Nicer numbering of headlines

%\usepackage[outer=3.35cm]{geometry} 	% Type area (size, margins...) !!!Release version
%\usepackage[outer=2.5cm]{geometry} 	% Type area (size, margins...) !!!Print version
%\usepackage{geometry} 					% Type area (size, margins...) !!!Proofread version
\usepackage[outer=3.15cm]{geometry} 	% Type area (size, margins...) !!!Draft version
\geometry{a4paper,body={5.8in,9in}}

\usepackage{graphicx}                   % Inclusion of graphics
%\usepackage{latexsym}                  % Special symbols
\usepackage{longtable}					% Allow tables over several pages
\usepackage{listings}                   % Nicer source code listings
\usepackage{multicol}					% Content of a table over several columns
\usepackage{multirow}					% Content of a table over several rows
\usepackage{rotating}					% Alows to rotate text and objects
\usepackage[hang]{subfigure}            % Allows to use multiple (partial) figures in a fig
%\usepackage[font=footnotesize,labelfont=rm]{subfig}	% Pictures in a floating environment
\usepackage{tabularx}					% Tables with fixed width but variable rows
\usepackage{url,xspace,boxedminipage}   % Accurate display of URLs
\usepackage{multirow}
\usepackage{tabulary}
\usepackage{float}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Configurationen:

\hyphenation{whe-ther} 					% Manually use: "\-" in a word: Staats\-ver\-trag

%\lstloadlanguages{C}                   % Set the default language for listings
\DeclareGraphicsExtensions{.pdf,.svg,.jpg,.png,.eps} % first try pdf, then eps, png and jpg
\graphicspath{{./src/}} 				% Path to a folder where all pictures are located
\pagestyle{fancy} 						% Use nicer header and footer

% Redefine the environments for floating objects:
\setcounter{topnumber}{3}
\setcounter{bottomnumber}{2}
\setcounter{totalnumber}{4}
\renewcommand{\topfraction}{0.9} 		%Standard: 0.7
\renewcommand{\bottomfraction}{0.5}		%Standard: 0.3
\renewcommand{\textfraction}{0.1}		%Standard: 0.2
\renewcommand{\floatpagefraction}{0.8} 	%Standard: 0.5

% Tables with a nicer padding:
\renewcommand{\arraystretch}{1.2}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Additional 'theorem' and 'definition' blocks:
\theoremstyle{plain}
\newtheorem{theorem}{Theorem}[section]
%\newtheorem{theorem}{Satz}[section]	% Wenn in Deutsch geschrieben wird.
\newtheorem{axiom}{Axiom}[section] 	
%\newtheorem{axiom}{Fakt}[chapter]		% Wenn in Deutsch geschrieben wird.
%Usage:%\begin{axiom}[optional description]%Main part%\end{fakt}

\theoremstyle{definition}
\newtheorem{definition}{Definition}[section]

%Additional types of axioms:
\newtheorem{lemma}[axiom]{Lemma}
\newtheorem{observation}[axiom]{Observation}

%Additional types of definitions:
\theoremstyle{remark}
%\newtheorem{remark}[definition]{Bemerkung} % Wenn in Deutsch geschrieben wird.
\newtheorem{remark}[definition]{Remark} 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Provides TODOs within the margin:
\newcommand{\TODO}[1]{\marginpar{\emph{\small{{\bf TODO: } #1}}}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Abbreviations and mathematical symbols
\newcommand{\modd}{\text{ mod }}
\newcommand{\RS}{\mathbb{R}}
\newcommand{\NS}{\mathbb{N}}
\newcommand{\ZS}{\mathbb{Z}}
\newcommand{\dnormal}{\mathit{N}}
\newcommand{\duniform}{\mathit{U}}

\newcommand{\erdos}{Erd\H{o}s}
\newcommand{\renyi}{-R\'{e}nyi}
\setlength{\parindent}{0pt}
\newcommand{\forceindent}{\leavevmode{\parindent=2em\indent}}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Document:
\begin{document}
\renewcommand{\headheight}{14.5pt}

\fancyhead{}
\fancyhead[LE]{ \slshape \trauthor}
\fancyhead[LO]{}
\fancyhead[RE]{}
\fancyhead[RO]{ \slshape \trtitle}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Cover Header:
\begin{titlepage}
	\begin{flushleft}
		Universit\"at Hamburg\\
		Department Informatik\\
		\trarbeitsbereich\\
	\end{flushleft}
	\vspace{3.5cm}
	\begin{center}
		\huge \trtitle\\
	\end{center}
	\vspace{3.5cm}
	\begin{center}
		\normalsize\trtype\\
		[0.2cm]
		\Large\trcourse\\
		[1.5cm]
		\Large \trauthor\\
		[0.2cm]
		\normalsize Matr.Nr. \trmatrikelnummer\\
		[0.2cm]
		\normalsize\tremail\\
		[1.5cm]
		\Large \trdate
	\end{center}
	\vfill
\end{titlepage}

	%backsite of cover sheet is empty!
\thispagestyle{empty}
\hspace{1cm}
\newpage

%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Abstract:

% Abstract gives a brief summary of the main points of a paper:
\section*{Abstract}
  

% Lists:
\setcounter{tocdepth}{2} 					% depth of the table of contents (for Seminars 2 is recommented)
\tableofcontents
\pagenumbering{arabic}
\clearpage

%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Content:

% the actual content, usually separated over a number of sections
% each section is assigned a label, in order to be able to put a
% crossreference to it

\graphicspath{{images/}}

\section{Introduction}
\label{sec:introduction}
\forceindent Walking on two feet is an activity that all of us take for granted. Yet this apparently simple action involves a host of complex mechanisms, both mechanical and neural, which are tied together to produce the efficient bipedal movements of human beings. The ability to move around on two legs has allowed humans to efficiently deal with a wide variety of terrains, be it flat grasslands or lush forests overrun by undergrowth or the concrete jungles which we now inhabit. Even from an evolutionary viewpoint, bipedal locomotion has enabled humans to move about while leaving their hands free to engage in more important tasks such as tool-making. The efficiency and versatility of biped movement is undeniable. It is only natural then, for us to desire our robots to have the same capabilities.\\ 
\forceindent While a vast majority of mobile robots today have wheels, the limitations of wheeled locomotion are obvious. Wheeled robots require a structured environment to operate in, and although certain types of wheeled robots can handle uneven terrain, their scope is still quite limited. Legged robots on the other hand can operate in much more diverse environments, and theoretically can handle any environment that humans can handle. As robots become more pervasive in society, the need for robots that can function in human environments will continue to grow. Even from a psychological perspective, anthropomorphic robots have the added advantage of being more acceptable to human users.\\
\forceindent However, the benefits of legged robots comes at a price. The challenges associated with bipedal movement are much more involved than those associated with wheeled locomotion. Bipedal locomotion is inherently unstable, and a considerable amount of effort goes into maintaining balance. The biped robot can be imagined as an inverted pendulum - even a small disturbance is enough to move it from its equilibrium position and unless corrective action is taken, the robot will topple over. In addition to this, bipedal locomotion is a complicated mix of the movements of different limbs in a synchronous fashion. Human walking involves multiple degrees of freedom and is achieved with the combined effort of muscles, bones, ligaments and tendons. Replicating this movement in robots using the conventional servo motors we have at our disposal today, is also a very difficult task.\\
\forceindent In the literature numerous approaches exist for solving the problem of bipedal locomotion. Perhaps the most popular approach is that of using the  Zero Moment Point (ZMP) introduced by Vukobratovic et al. in 1969 \cite{vukobratovic1969contribution, jurivcic1972mathematical}. In the decades since its inception, ZMP has been a popular choice for researchers around the world dealing with the problem of bipedal robots. ZMP is defined as that point on the ground at which the net moment of the inertial forces and the gravity forces has no component along the horizontal axes \cite{vukobratovic2004zero}. By ensuring that the ZMP always lies within the support polygon of the robot, dynamical stability of the system can be ensured. The approach then is to find a suitable trajectory of the ZMP and then to use inverse kinematics to figure out what the individual joint angle trajectories should be which satisfy the required ZMP trajectory. A very famous example of a ZMP based robot is Honda's ASIMO \cite{sakagami2002intelligent}, which is capable of an astonishing range of movements including stable walking and climbing stairs.\\
\forceindent However despite the popularity of ZMP based robots, the technique has some considerable limitations. Firstly, the computation of ZMP and the subsequent computation of joint angle trajectories is computationally intensive and has a considerable dependency on the availability of an accurate model of the robot. Secondly, ZMP based robots move in a very conservative manner with bent knees and slow carefully placed steps. In this sense, the movement of robots such as ASIMO are very different from the movement of humans, which is characterized by almost straight knees and fast efficient steps. Animals are adept at utilizing the natural dynamics of their bodies for walking. This leads to a highly energy efficient mode of transport. ZMP based robots, on the other hand, cancel out the natural dynamics of the mechanical system in an effort to maintain control over the system at all times, and this leads to high energy consumption.\\
\forceindent As with so many other areas of robotics, for walking too, we can draw inspiration from nature and build systems that try to emulate the mechanisms present in animals. This is the approach followed in this paper, where a neural mechanism known as Central Pattern Generators is utilized in an effort to develop a model-free bipedal locomotion approach. The remainder of this paper is organized as follows. In section \ref{sec:Related_Work}, some relevant work is discussed in the area of bipedal locomotion with a focus on biologically inspired approaches. This is followed in section \ref{sec:Biological_Motivation} by a discussion of the biological background of neural mechanisms that enable animals to walk. Section \ref{sec:Matsuoka_Oscillator} introduces Central Pattern Generators and contains an in-depth discussion of the Matsuoka oscillator and its properties. Section \ref{sec:Coupled_Oscillators} elaborates on the use of Matsuoka oscillators and illustrates how multiple oscillators can be linked together to achieve desired movements. This is followed by section \ref{sec:Robot_Joint_Control}, where the process of employing an oscillator to control the joints of a commercially available position controlled robot is described. In section \ref{sec:Walk_Optimization}, different variants of the Particle Swarm Optimization algorithm are used to tune a network of Matsuoka oscillators to find a stable bipedal gait. Section \ref{sec:Discussion} discusses the observed effects and comparative performance of the PSO variants and section \ref{sec:Future_Work} lists the ways in which the system can be extended. Finally section \ref{sec:Conclusion} contains concluding remarks about the work presented in this paper.



\section{Related Work}
\label{sec:Related_Work}
\forceindent The study of bipedal robots has gained much momentum over recent years. However it was the pioneering work of Vukobratovic \cite{vukobratovic1969contribution} \cite{jurivcic1972mathematical} and Kato \cite{kato1973development} that kick started interest in the field of humanoid robotics. The first humanoid robot WABOT 1 was developed in 1973 by Kato and his team at the Waseda University in Japan. At the same time Vukobratovic and his team were working on problems associated with functional rehabilitation. They developed the first robotic exoskeletons at the Mihajlo Pupin Institute in erstwhile Yugoslavia. The most important outcome from this work was the concept of ZMP that has been used widely since. Later years saw the emergence of a number of legged robots from the Ohio State University, the Carnegie Mellon University and the Leg Laboratory at the Massachusetts Institute of Technology in the United States \cite{siciliano2008springer}. Nowadays, the most notable humanoids include ASIMO from honda \cite{sakagami2002intelligent}, QRIO from Sony and the HRP robot from Kawada industries. Realtively cheap commercial humanoids such as the Nao robot from Aldebaran Robotics and the Darwin from Robotis are also available.\\
\forceindent The wide availability of appropraite hardware has acted as a catalyst to research on the mechanisms of walking. Research has yeilded a number of different ways in which humanoid robots can be made to walk in a stable manner. These may be loosely grouped into the following categories:\\
\begin{enumerate}
\item \textbf{ZMP and Linear Inverted Pendulum based approaches}: This is arguably the most popular approach adopted for humanoid locomotion. In \cite{kajita2003biped}, Kajita et al. present a method to generate ZMP and Center of Mass (CoM) trajectories of the robot using a technique known as preview control, where the reference ZMP is known for a few seconds into the future. In \cite{kajita2010biped} Kajita et al., achieve stabiliyation using the Linear Inverted Pendulum (LIP) model on a 42-degree-of-freedom (DoF) adult sized humanoid robot. In \cite{kajita20013d}, the authors present a simplified model (3D-LIP) which can be used to accurately model the dynamics of a high DoF robot.
\item \textbf{Passive Bipedal Walking:} Despite the popularity of ZMP based techniques, the gait of even highly sophisticated humanoid robots aśuch as ASIMO is very different from the gait of humans, which is characterized by ease of movement and energy efficiency. McGeer's work \cite{mcgeer1990passive} has shown that highly efficient human like gait can be achieved even by an unactuated humanoid walking down a ramp, when it can efficiently utilize the dynamics of its mechanical structure. Further related research is presented in \cite{kuo1999stabilization} and \cite{collins2005efficient}.
\item \textbf{Push Recovery and Capture Steps: } In \cite{missura2013omnidirectional, missura2014online, missura2015gradient} the authors argue that pure ZMP based methods rely on sophisticated hardware and are not suitable in situations where the robot may be subject to strong disturbances. The authors have presented a hierarchical gait control architecture where balance control is separated from motion generation. This architecture relies on the LIP model and is able to resist strong disturbances using a combination of different strategies including ZMP. In \cite{stephens2007humanoid}, simple models for humanoids are investigated with respect to push recovery and different recovery strategies are explored. In \cite{rebula2007learning} a strategy for learning capture points for push recovery is presented.
\item \textbf{Reflexive and Sensorimotor control: } In \cite{geng2005fast} a neural ntwork controlled biped walker is presented. A reflexive hierarchical controller controls biped walking without any kind of trajectory control. Reinforcement learning is used to tune the parameters of the controller. In \cite{paul2005sensorimotor} sensorimotor neural networks (one for each leg) control the motion of the biped. The network is optimized using a genetic algorithm. Rythmic motion is generated without the use of recurrent connections.
\item \textbf{Evolution of Central Pattern Generators: } Central Pattern Generators are biological neural networks which produce rythmic output on their own without the need of any sensory feedback. The output of the individual networks control the movement of the individual limbs and can be modulated using sensory feedback to produce different kinds of motion. Typically the parameters of the CPG are tuned using some kind of evolutionary algorithm. Various mathematical models, known as oscillators, are available which encapsulate the behavior of the CPG in the form of coupled nonlinear differential equations. The most used oscillators are the Van der Pol oscillator \cite{kanamaru2007van}, the Hopf oscillator \cite{Righetti2006} and the Matsuoka oscillator \cite{Matsuoka1985,Matsuoka1987}. In \cite{Righetti2006} and \cite{Kieboom2009}, Hopf oscillators have been used for pattern generation, along with some feedback mechanisms for stabilizations. Taga \cite{Taga1991} produced the seminal work in which Matsuoka oscillators were used for gait generation of a two dimensional planar biped robot. Ishiguro et al. \cite{Ishiguro2003} present an approach in which a CPG circuit is modulated using simulated neuromodulators to achieve stable bipedal locomotion. In \cite{reil2002evolution} a recurrent neural network is used as a pattern generator and an evolutionary algorithm is used for evolving the network parameters. The motion produced, however, is not suitable for rough terrain and may be used as a starting point for stable walking. In \cite{Ijspeert2008} Ijspeert presents a comprehensive review of the use of CPGs for locomotion control.
\end{enumerate}

\section{Biological Motivation}
\label{sec:Biological_Motivation}
\forceindent The primary objective of research in bipedal robots is to build systems which can walk efficiently on different terrains. In this respect, human levels of performance maybe considered as the benchmark, and thus it is worthwhile to investigate the biological mechanisms that allow humans to walk with such graceful ease and nonchalance. In both higher level vertebrates such as humans as well as in invertebrates, neural circuits known as Central Pattern Generators are responsible for producing the rythmic movements which are responsible for locomotion \cite{Ijspeert2008}. These CPGs can produce rythmic patterns of neural activity without the need of rythmic or sensory inputs, and they are the basis of fundamental activities such as chewing, breathing and locomotion. Several studies have proven the existance of CPGs in animals and their responsibility for the movements of the animals \cite{cohen1980neuronal,grillner1985neural,stein1999neurons}. Although sensory feedback is not required to generate the rythmic patterns by CPGs, it plays an important role in modulating the rythmic patterns \cite{Ijspeert2008}. Vertebrate locomotor systems are organized such that the CPGs are responsible for producing basic rythmic patterns and the higher brain centers modulate these patterns based on external sensory inputs \cite{Ijspeert2008}. Such an organization has important consequences, even from a robotics perspective, since it drastically reduces the dimensionality of higher level control signals. The higher centers do not need to specify individual muscle (or joint) activity and instead only need to modulate the CPG activity using a small set of parameters.\\
\forceindent A general framework for the nervous control of motor systems is illustrated in figure \ref{fig:neural_comp}. The first element in this framework is the Cenral Pattern Generator, located in the spinal cord \cite{neurobiology1994shepherd}. This is responsible for neural mechanisms for generating coordinated rythmic outputs for the motoneurons. The CPG in turn is controlled and modulated by the higher motor centers, which form the hierarchy of motor control. There also exist feedback circuits which relay information from the muscles (proprioceptive feedback) and from the environment through other sensory pathways \cite{neurobiology1994shepherd}. The feedback information is transmitted from lower to higher centers. The proprioceptive feedback informs the higher center about any deviations that exist between the commanded signal and the output \cite{neurobiology1994shepherd}.


\begin{figure}[htbp]
\centering     %%% not \center
\subfigure[Neural components of motor systems. Feedback information flows from the lower centers to the higher centers. Sensory input to CPG is only used for modulation. The CPGs can produce rhythmic output in the absence of sensory input as well \cite{neurobiology1994shepherd}]{\label{fig:neural_comp}\includegraphics[scale=0.33]{figures/neural_comp.png}}
\subfigure[Half-center model. D denotes driver neurons which supply a constant input, E and F are the extensor and flexor motoneurons respectively. Filled profiles indicate inhibitory neurons, open profiles denote excitatory neurons \cite{neurobiology1994shepherd}]{\label{fig:half_center}\includegraphics[scale=0.27]{figures/half_center_model.png}}
\caption{Neural components of motor systems and a half-center CPG model \cite{neurobiology1994shepherd}}
\end{figure}


\forceindent One of the main functions of motor systems is the genration of oscillatory patterns of muscle activity. This property rests with neural circuits which make up the Central Pattern Generator. The CPG circuitry may be either local or distributed, and generally belong to one of three major categories: the half-center model, the closed-loop model and the pacemaker model \cite{neurobiology1994shepherd}. Only the half-center model is discussed here as it is relevant to the material in the subsequent sections. The interested reader is referred to \cite{neurobiology1994shepherd} for details of the other models.\\
\forceindent The half-center model, as shown in figure \ref{fig:half_center}, was first proposed by Brown \cite{brown1914nature} to explain the alternating activation of the flexor and extensor muscles of a decerebrated cat's limbs during walking on a treadmill. Each pool of motor neurons for flexor (F) or extensor (E) is activated by a corresponding half-center of interneurons. Another set of neurons (D) provides a constant excitatory drive to the half-centers.Each half-center has inhibitory connections to the other half-center, and this ensures that when one pool is activated, the other one is deactivated. According to Brown, as the first half-center was activated, a process of fatigue would build up in the inhibitory connection between the half-centers which would ultimately lead to a switching of activity between the half-centers. The process of fatigue can be modelled by any process that induces self-inhibition of the active half-centers \cite{neurobiology1994shepherd}.\\
\forceindent The inherent properties of CPGs make them a suitable candidate for the locomotion control of legged robots, as opposed to controllers based on pre-recorded trajectories, finite-state machines or ZMP \cite{Ijspeert2008}. First of all, CPG based models display stable limit cycle behavior, which means that although the generated patterns may be modified under the effect of a disturbance, as soon as the disturbance is removed, the CPG goes back to its normal behavior. This property maybe beneficial in situations where robots need to tackle uneven terrain. Secondly, CPG based controllers have very few parameters and hence higher level controllers need not deal with low level motor commands but only need to produce high-level control signals to modulate the pattern that the CPG produces on its own. Thirdly, CPGs can handle sensory feedback easily, since the feedback signals can be convineantly added as coupling terms in the differential equations. This also leads to the property of entrainment, where the CPG tunes itself to the dynamics of the mechanical system and can effectively utilize the mechanics of the robot for locomotion \cite{Ijspeert2008}. This property will also be touched upon later on, when the mathematical model of the CPG, as used on the robot, is discussed.


\section{Choice of Oscillator}
\label{sec:Choice_of_Oscillator}
\forceindent Based on the arguments presented in the previous sections, if one is convinced that CPGs offer a promising way of building walking controllers for bipedal robots, then the immediate question which arises is which oscillator is a viable choice for the CPG, given that there are many possible candidates. From a robotics perspective, the most used oscillators are the Hopf oscillator and the Matsuoka oscillator. \\
\forceindent The Hopf oscillator has been used successfully by Righetti and Ijspeert \cite{Righetti2006} and by Kieboom \cite{Kieboom2009} to design controllers for a bipedal robot. Matsuoka oscillators have also been used for the same purpose by Taga \cite{Taga1991}, Ishiguro et al. \cite{Ishiguro2003} and by Cristiano et al. \cite{cristiano2014locomotion}. The Hopf oscillator is well defined in terms of amplitude and frequency, is easy to control and has strong limit cycle properties \cite{Kieboom2009}. Moreover, different oscillators maybe easy combined to produce complex output patterns \cite{Righetti2006}. \\
\forceindent However, in spite of these advantages, the Hopf oscillator has a limitation that restricts its usage. In order to produce a suitable pattern, the Hopf oscillator needs an appropriate teaching signal to which the oscillator entrains. Once the pattern has been learned, the teaching signal can be removed and the Hopf oscillator will continue to produce a pattern similar to the teaching signal. In \cite{Righetti2006}, the authors have used the joint angle patterns produced by the manufacturer-provided walking algorithm as the teaching signal to train the oscillator network. The problem with this approach is that, the CPG based walking algorithm will produce the same gait as the default algorithm, and the system will not be able to efficiently utilize the robot's structural dynamics to its advantage. If the default algorithm made the robot walk with bent knees, the CPG based algorithm will do the same. For a new robot, a default walking algorithm may not be even available. In \cite{Kieboom2009}, the author has used a system of sine generators and optimized the parameters of the sine wave equations using a PSO. The optimized sine generators were then used as the teaching signal for the network of Hopf oscillators. Here additional effort is spent in optimizing the sine equation parameters, and again the teaching signals themselves are very simple and cannot efficiently utilize the robot's mechanics to its advantage.\\
\forceindent The Matsuoka oscillator does not need a teaching signal and can be optimized in a singe step to generate waveforms of a desired nature and can be entrained with the mechanics of the biped in an automatic sense \cite{Kieboom2009}. However, the equations are more complex than the Hopf oscillator equations and involve more tunable parameters. The disadvantages of using a Matsuoka oscillator seem insignificant when one considers the advantages. Additionally, among the different oscillators, Matusoka oscillators are the most plausible biologically and the two-neuron Matsuoka oscillator \cite{Matsuoka1987} bears a very close resemblance to the half-center model described in section \ref{sec:Biological_Motivation}. Keeping in mind the relative advantages of the Matsuoka oscillator over the Hopf oscillator, it has been chosen as the oscillator model for implementing the CPGs in this paper.


\section{Matsuoka Oscillator}
\label{sec:Matsuoka_Oscillator}
\forceindent The Matsuoka oscillator is a mathematical model representing a general class of neural rhythm generators called mutual inhibition networks \cite{Matsuoka1987}. In this oscillator a set of neurons inhibit each others activities. For the individual neurons, a continuous-time continuous-variable neuron model is adopted \cite{Matsuoka1987}. The autonomous dynamics of the model are based on a piece-wise linear set of differential equations which model the dynamics of neural discharge rates. The oscillator consists of a pair of mutually inhibitory neurons whose rates of discharge are denoted by $\psi_i$ and $\psi_j$ respectively. The firing rates obey the following equations \cite{Ronsse2009}: 
\begin{subequations} 
\label{eq:matsuoka_basic}
\begin{align}
 t_1 \dot{\psi_i}=-\psi_i - \beta \phi_i - \eta [\psi_j]^+ + u_i\\
 t_1 \dot{\psi_j}=-\psi_j - \beta \phi_j - \eta [\psi_i]^+ + u_j
 \end{align}
\end{subequations}
where $t_1$ is the time constant for the rate of discharge, $\beta$ is the self-inhibition constant and $\eta$ is the constant of mutual inhibition. $u_i$ and $u_j$ denote the constant (tonic) input signals that drive the oscillator. $[\textbf{\textbullet}]^+=max(0,\textbf{\textbullet})$ implies that only the positive part of the discharge rates is considered for mutual inhibition. Equation  \ref{eq:matsuoka_basic} can be further extended by including terms representing the proprioceptive feedback, which will enable the system to monitor and rectify errors between the commanded and executed trajectories. A way of doing this was suggested by \cite{Williamson1998}, by including the sensory feedback into the firing rate equations (equation \ref{eq:matsuoka_basic}). On doing so these equations are modified into:
\begin{subequations} 
\label{eq:matsuoka_extended}
\begin{align}
 t_1 \dot{\psi_i}=-\psi_i - \beta \phi_i - \eta [\psi_j]^+ - \sigma [\theta - \theta^{*}] + u_i\\
 t_1 \dot{\psi_j}=-\psi_j - \beta \phi_j - \eta [\psi_i]^+ - \sigma [-(\theta - \theta^{*})] + u_j
 \end{align}
\end{subequations}
Here, $\sigma$ is the strength of the sensory feedback, $\theta$ denotes the proprioceptive feedback and $\theta^{*}$ denotes the desired reference output angle (the mean position about which oscillations should occur). It should be kept in mind that this sensory feedback is not required for producing oscillations but only to make sure that the oscillations occur about a reference position. Two other state variables, $\phi_i$ and $\phi_j$ control the self-inhibition, and obey the following equations \cite{Ronsse2009}: 
\begin{subequations} 
\label{eq:matsuoka_phi}
\begin{align}
 t_2 \dot{\phi_i}=-\phi_i + [\psi_i]^+\\
 t_2 \dot{\phi_j}=-\phi_j + [\psi_j]^+
 \end{align}
\end{subequations}
Here, $t_2$ is the time constant of adaptation or fatigue. The time constants $t_1$ and $t_2$ play an important role in the generation of oscillations. The discharge of a neuron with a constant input $u$ will first rise to a maximum value in a time governed by $t_1$ and then gradually decrease to a lower value in a time governed by $t_2$. Robust oscillations emerge due to a balance between self-inhibition and mutual-inhibition. The discharge rates $\psi_i$ and $\psi_j$ are assumed to be proportional to the torque generated in the positive and negative directions respectively. Hence the net torque is given by: 
\begin{equation}
\label{eq:matsuoka_net_torque}
\psi_T=h_{\psi}([\psi_i]^+ - [\psi_j]^+)
\end{equation}
where $h_{\psi}$ is the gain factor. The resultant torque can be converted into the desired joint velocity $\dot{\theta}$ and angular position $\theta$ by solving the following differential equation of a simple inertial mechanical system \cite{Ronsse2009}:
\begin{equation}
I\ddot{\theta} + \gamma \dot{\theta} - \psi_T = 0
\end{equation}
Here, $I$ is the moment of inertia and $\gamma$ is the damping constant. A pictorial representation of a Matsuoka oscillator driving a single joint (with proprioceptive feedback) is shown in figure \ref{fig:matsuoka_diagram}.

\begin{figure}[hbtp]
\centering
\includegraphics[scale=0.25]{figures/matsuoka_diagram.png}
\caption{Matsuoka oscillator driving two antagonistic muscles, producing a 1-DoF movement at the elbow. The difference of the torques produced by the two neurons is the net torque that drives the joint. Proprioceptive feedback is denoted by the gray line. Lines with empty circles at the end denote inhibitory connections. The symbols have the same meaning as in equations \ref{eq:matsuoka_basic}, \ref{eq:matsuoka_extended} and \ref{eq:matsuoka_phi} \cite{Ronsse2009}.}
\label{fig:matsuoka_diagram}
\end{figure}

\forceindent Since the basic equations of the Matsuoka oscillator are now in place, it is worthwhile to investigate how the parameters of the oscillator affect the output pattern. This will lead to a better understanding of how to achieve desired movements of the robot by changing oscillator parameters. According to equations \ref{eq:matsuoka_basic}-\ref{eq:matsuoka_net_torque}, the parameters of the oscillator are $t_1$ (time constant for the rate of discharge), $t_2$ (time constant of fatigue), $\beta$ (self-inhibition constant), $\eta$ (mutual-inhibition constant), $u_i$, $u_j$ (tonic inputs, it is assumed that $u_i=u_j$) , $\sigma$ (strength of sensory feedback),  $\theta^*$ (desired reference angular position) and $h_{\psi}$ (torque gain). $\psi_i$, $\psi_j$, $\phi_i$, $\phi_j$ are the state variables, whose behavior is dependent on the oscillator parameters.\\ 
\forceindent First the effect of changing the desired reference position on the angular trajectory is demonstrated. On its own, the Matsuoka oscillator produces oscillations about an arbitrary position, and the system itself is dynamically unstable. However, with the introduction of a feedback term, the mean position of oscillations can be controlled \cite{Ronsse2009}. This is shown in figure \ref{fig:change-avg-pos}. Here for the first 10 seconds $\theta^*=0$ radians, from 10-20s, $\theta^*=1$ radian and from 20-30s $\theta^*=-1$ radian. As illustrated by the joint position graph, the mean oscillation position changes and the transition is smooth without any abrupt changes. The values of the other parameters are set as $t_1=0.25$, $t_2= 2.5 \times t_1$ as per \cite{Ronsse2009}, $\beta=2.5$,  $\eta=2.5$, $u_i=u_j=1$, $\sigma=1.5$ and $h_{\psi}=5.0$. This kind of situation maybe encountered when the robot initially moves on a flat surface and then steps upon an inclined surface. At this point the robot would have to move its center of mass forward by bending a little and the mean oscillation position of some joints would change.

\begin{figure}[htbp]
\centering     %%% not \center
\subfigure[Torque output of the oscillator]{\includegraphics[scale=0.21]{figures/1-2-torque-for-change-average-position.eps}}
\subfigure[Joint position and average joint position]{\includegraphics[scale=0.21]{figures/1-1-change-average-position.eps}}
\caption{Changing the average position of oscillation}
\label{fig:change-avg-pos}
\end{figure}

\forceindent Next, the effect of changing the tonic input is demonstrated. 
The tonic input to the oscillator is linearly related to the amplitude of the torque output and also approximately linearly to the amplitude of the position oscillations. In this example, the tonic input was linearly increased from 1.0 to 4.0 over 30 seconds, and as shown in figure \ref{fig:change-amp}, the amplitude of both the oscillations increases in a linear manner. This is possible in a situation where the robot needs to change the length of its stride to move over an obstacle or to step onto a stair. As is visible from the graphs, the transitions from one amplitude to the next are smooth. The values of the parameters other than the tonic input were $t_1=0.25$, $t_2= 2.5 \times t_1$ as per \cite{Ronsse2009}, $\beta=2.5$,  $\eta=2.5$, $\sigma=1.5$, $theta^*=0$ and $h_{\psi}=5.0$.

\begin{figure}[htbp]
\centering     %%% not \center
\subfigure[Torque output of the oscillator]{\includegraphics[scale=0.21]{figures/2-1-change-in-torque.eps}}
\subfigure[Joint position and average joint position]{\includegraphics[scale=0.21]{figures/2-2-change-in-angle.eps}}
\caption{Changing the amplitude of oscillations}
\label{fig:change-amp}
\end{figure}

\forceindent Apart from the mean position and amplitude, another key property of a waveform is its frequency. By varying the time constants of the oscillator the frequency of the torque and joint angle oscillations can be varied. In figure \ref{fig:change-freq}, the time constant $t_1$ was set to 0.3 for the first 20 seconds, 0.6 for the next 20 seconds and to 0.9 for the last 20 seconds. The constant $t_2$ was set as $t_2 = 2.5 \times t_1$ as in \cite{Ronsse2009}. As expected the frequency of both the torque and the joint angle oscillations decreases. However for the joint angles, the amplitude also increases as the frequency decreases. This effect maybe countered by gradually decreasing the tonic input as the frequency decreases in order to keep the amplitude constant. This kind of a situation can occur when the robot needs to change its speed of walking. The values of the parameters other than the time constants were $\beta=2.5$,  $\eta=2.5$, $\sigma=1.5$, $u_i=u_j=1$, $theta^*=0$ and $h_{\psi}=5.0$. Note that for both the  transitions (at $t=20s$ and $t=40s$), the changes were smooth. 

\begin{figure}[htbp]
\centering     %%% not \center
\subfigure[Torque output of the oscillator]{\includegraphics[scale=0.21]{figures/3-1-changing-freq-torque.eps}}
\subfigure[Joint position and average joint position]{\includegraphics[scale=0.21]{figures/3-2-changing-freq-pos.eps}}
\caption{Changing the frequency of oscillation}
\label{fig:change-freq}
\end{figure}


\forceindent So far, the behavior of only a single oscillator driving a solitary joint has been described. In a robot, however, multiple joints must interact with one another in a way that leads to a stable gait. In order to do so, the oscillators driving the individual joints must have a way of communicating with each other.\\

Write about different kinds of coupling


\begin{figure}[htbp]
\centering     %%% not \center
\subfigure[Anti-phase oscillations]{\label{fig:b}\includegraphics[scale=0.35]{figures/4-1-anti-phase.eps}}
\subfigure[In-phase oscillations]{\label{fig:a}\includegraphics[scale=0.35]{figures/4-2-in-phase.eps}}
\caption{Anti-phase and in-phase oscillations}
\label{fig:in-anti-phase}
\end{figure}

\subsection{Stable attractors}



\begin{figure}[H]
\centering
\includegraphics[scale=0.55]{figures/5-1-stable-attractors.eps}
\caption{Stable attractors for a broad range of time periods and initial phase difference between the two joints. As shown here, once the mutual coupling between the 2 joints is switched on, the joint oscillations converge to only 2 modes - either in-phase (0 phase difference) or anti-phase ($\pi$ phase difference).}
\label{fig:stable-attractors}
\end{figure}

\section{Coupled Oscillators}
\label{sec:Coupled_Oscillators}

\section{Robot Joint Control}
\label{sec:Robot_Joint_Control}

\section{Walk Optimization}
\label{sec:Walk_Optimization}

\section{Discussion}
\label{sec:Discussion}

\section{Future Work}
\label{sec:Future_Work}

\section{Conclusion}
\label{sec:Conclusion}

\cite{ronsse2009computational, williamson1998neural, matsuoka1987mechanisms, matsuoka1985sustained,Ishiguro2003}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% hier werden - zum Ende des Textes - die bibliographischen Referenzen
% eingebunden
%
% Insbesondere stehen die eigentlichen Informationen in der Datei
% ``bib.bib''
%
\bibliographystyle{plain}
\bibliography{primary,secondary}
\end{document}


